# T-002: Setup Prisma 7 + PostgreSQL + Docker Compose

| Campo | Valor |
|-------|-------|
| **Tamanho** | M |
| **Prioridade** | Must Have |
| **Epic** | Setup |
| **Depende de** | T-001 |

---

## Contexto

Configurar banco de dados PostgreSQL local via Docker Compose e ORM Prisma 7 com Driver Adapters.

## Objetivo

Prisma 7 configurado com PostgreSQL rodando localmente via Docker, pronto para criar schemas e migrations.

## Escopo

- Criar docker-compose.yml para PostgreSQL 16
- Instalar Prisma 7 com @prisma/adapter-pg
- Configurar prisma.config.ts (obrigatorio no Prisma 7)
- Criar schema.prisma inicial
- Configurar Prisma Client singleton
- Criar .env.local com DATABASE_URL

## Arquivos a Criar

```
youfluent/
├── docker-compose.yml
├── prisma/
│   ├── schema.prisma
│   └── prisma.config.ts
├── src/
│   └── shared/
│       └── lib/
│           └── prisma.ts
└── .env.local
```

## Implementacao

```yaml
# docker-compose.yml
services:
  db:
    image: postgres:16
    container_name: youfluent-db
    restart: unless-stopped
    environment:
      POSTGRES_USER: youfluent
      POSTGRES_PASSWORD: youfluent_dev
      POSTGRES_DB: youfluent
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  postgres_data:
```

```typescript
// prisma.config.ts
import { defineConfig } from 'prisma'

export default defineConfig({
  earlyAccess: true,
  schema: './prisma/schema.prisma',
})
```

## Criterios de Aceite

- [ ] `docker compose up -d` sobe PostgreSQL
- [ ] Conexao com banco funciona
- [ ] `pnpm prisma generate` gera client
- [ ] `pnpm prisma db push` aplica schema
- [ ] Prisma Client singleton configurado

## Validacao

```bash
docker compose up -d
docker compose ps
pnpm prisma generate
pnpm prisma db push
pnpm build
```

---

## Tags de Contexto

```
ARQUITETURA: stack, decisoes/adr-002-prisma-7
```

---

## Notas

- Prisma 7 REQUER Driver Adapters (@prisma/adapter-pg)
- Prisma 7 REQUER prisma.config.ts
- Node.js 20.19+ obrigatorio
- TypeScript 5.4+ obrigatorio
